version: '3.10'

services:
      app:
            build:  .
            command: python manage.py runserver 0.0.0.0:8000
            volumes:
                  - /static_data:/app/static
            ports:
                  - "8000:8000"
            restart: always
            env_file:
                  - ./.env
            depends_on:
                  - db
      db:
            image: postgres:13.0-alpine
            restart: always
            volumes:
                  - /postgres_data:/var/lib/postgresql/data:rw
            env_file:
                  - .env
            environment:
                  - POSTGRES_DATA=/var/lib/postgresql/data/pgdata
                  - POSTGRES_USER=${DB_USERNAME}
                  - POSTGRES_PASSWORD=${DB_PASSWORD}
                  - POSTGRES_DB=${DB_NAME}
            ports:
                  - '5432:5432'
        